# Инструкция по локальному тестированию Telegram Mini App

## Подготовка

1. Установите зависимости Python:
```
pip install -r requirements.txt
```

2. Создайте файл `.env` на основе `.env.example` и настройте для локального тестирования:
```
BOT_TOKEN=ВАШ_ТОКЕН_БОТА_ЗДЕСЬ
WEBAPP_URL=http://localhost:3000
HOST=127.0.0.1
PORT=8443
SECRET_KEY=локальный_секретный_ключ
```

## Запуск фронтенда

Запустите локальный сервер для фронтенда:
```
npx serve
```

Фронтенд будет доступен по адресу: http://localhost:3000

## Запуск бэкенда

В отдельном терминале запустите бэкенд:
```
python bot.py
```

API будет доступно по адресу: http://127.0.0.1:8444/api

## Тестирование

### Тестирование фронтенда

Откройте браузер и перейдите по адресу: http://localhost:3000

Поскольку мы находимся вне Telegram, используется режим локального тестирования с фейковыми данными пользователя. Вы должны увидеть:

1. Основной интерфейс приложения
2. При нажатии на кнопку будет отображаться информация о тестовом пользователе
3. В консоли браузера можно увидеть логи работы с фейковым Telegram API

### Тестирование бэкенда

Для быстрого тестирования API без взаимодействия через бота:
```
python test_backend.py
```

Этот скрипт выполняет тесты основных API-эндпоинтов.

## Тестирование в Telegram

Для полноценного тестирования в Telegram:

1. Получите токен бота через [@BotFather](https://t.me/BotFather)
2. Укажите токен в файле `.env`
3. Используйте [ngrok](https://ngrok.com/) для создания публичного URL:
   ```
   ngrok http 3000
   ```
4. Обновите `WEBAPP_URL` в `.env` на URL, полученный от ngrok
5. Перезапустите бота
6. Настройте Bot Menu через BotFather, указав URL вашего ngrok

## Решение проблем

### Проблема: Не удается подключиться к API
- Убедитесь, что бэкенд запущен
- Проверьте, что порты не заняты другими приложениями

### Проблема: Фронтенд не отображает данные
- Проверьте консоль браузера на наличие ошибок
- Убедитесь, что файл `app.js` правильно загружается 